<script src="//maps.google.com/maps/api/js?key=AIzaSyCPph-nckquoJBP9nTx8qe8b1qXRGHwjpQ"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script>
<!-- only if you need custom infoboxes -->


<h1>Ontario Fishing Records</h1>

<A HREF="javascript:history.go(0)">Click to refresh the map</A>

  <div style='width: 800px;'>
    <div id="map" style='margin-top:10px; width: 800px; height: 400px;'></div>
  </div>

  <script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap({
      provider: {
        //disableDefaultUI: true,
        zoom: 5,
        center: {lat: 48, lng: -83},
        // pass in other Google Maps API options here
      },
      internal: {
        id: 'map'
      }
    },
    function(){
    //   markers = handler.addMarkers([
    //    {"lat": 55, "lng": -100, 'marker': '<span>Ontario!</span>'},
    //    {"lat": 55, "lng": -110, 'marker': '<span>Ontario!</span>'},
    //    {"lat": 55, "lng": -120, 'marker': '<span>Ontario!</span>'}
    //  ]);
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
    }
  );

  google.maps.event.addDomListener(document.getElementById("Atlantic Salmon"), "click", function(ev) {
        map.setCenter(position: new google.maps.LatLng(record[1].latitude, record[1].longitude), map: map, title: 'Atlantic Salmon');
  </script>

  <br /><br />
  <table>
    <tr>
      <th>Species</th>
      <th>Weight (lbs.)</th>
    </tr>

    <% @records.each do |record| %>
      <tr>
        <td><%= record.species %></td>
        <td><%= record.weight %></td>
        <td>
          <a id="marker0">Show on Map</a>
        </td>

        <!-- <td><%= link_to 'Info', record_path(record) %></td> -->
        <a href="#" id="marker0">Show On Map</a>
      </tr>
    <% end %>
  </table>

  <script>
    google.maps.event.addDomListener(
        document.getElementById("marker0"), "click", function() {
              markers[0].openInfoWindowHtml('<b>MARKER 2</b><br/><i>This is fun!</i>');

              // map.setCenter(new google.maps.LatLng(markers[0].serviceObject.position.lat(), markers[0].serviceObject.position.lng()));
              marker[0].setMap(map);
        }
   );
  </script>
